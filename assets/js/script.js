const translations = {
  en: {
    skip_link: "Skip to content",
    nav_home: "Home",
    nav_about: "About",
    nav_wall: "Wall",
    nav_code: "Code",
    nav_contact: "Contact",
    wordmark: "cepelinai",
    title_home: "cepelinai | Home",
    title_about: "cepelinai | About",
    title_wall: "cepelinai | Wall",
    title_code: "cepelinai | Code",
    title_contact: "cepelinai | Contact",
    title_404: "cepelinai | 404",
    lang_toggle_label: "Toggle language",
    footer_title: "Thank you for being here",
    footer_line: "I’m grateful for every kind message and every shared lead.",
    footer_copyright: "© 2026 cepelinai. Built with care.",
    social_ig_label: "Instagram",
    social_fb_label: "Facebook",
    social_yt_label: "YouTube",
    social_in_label: "LinkedIn",
    hero_title: "A slow, hopeful build",
    hero_sentence:
      "This is my journal on the process of purchasing land and building a homestead home, hoping to mix the right ingredients to make something beautiful.",
    hero_support:
      "I’m Terence, writing down the quiet steps toward a small homestead in Lithuania — the paperwork, the people, and the everyday learning.",
    hero_support_two:
      "If you’re nearby or know the land, I’d love to hear stories, advice, or gentle warnings from those who’ve walked this road.",
    hero_button_meet: "Meet me",
    hero_button_wall: "Join the wall",
    gentle_title: "Gentle invitations",
    card_land_title: "Land and settling in",
    card_land_body:
      "How do you search wisely, visit villages respectfully, and begin to feel at home?",
    card_notary_title: "Notary and legal guidance",
    card_notary_body:
      "Are you a notary, or do you know one who can guide a newcomer through the process?",
    card_sale_title: "Land for sale and local knowledge",
    card_sale_body:
      "Do you know families considering a sale, or land that might fit a slow, careful build?",
    card_community_title: "Community connections",
    card_community_body:
      "I’m grateful for introductions to neighbors, growers, and people who love their place.",
    stay_title: "Stay connected",
    stay_body:
      "If you’d like occasional updates, leave your email and I’ll send a short note now and then.",
    stay_email_label: "Email address",
    stay_email_placeholder: "you@example.com",
    stay_button: "Join updates",
    stay_warning:
      "This email form is connected to a placeholder Formspree ID. Replace it before collecting signups.",
    about_title: "About Terence",
    about_intro_one:
      "My name is Terence. I’m from London, England. I’m a full stack software developer.",
    about_intro_two:
      "I’m relocating to Lithuania to buy land and build a homestead — my own bit of paradise — and I want to do it with patience and respect.",
    about_intro_three:
      "I hope to be a good neighbour, listen first, and learn the rhythms of the communities I’m joining.",
    about_card_one_title: "Who I am",
    about_card_one_body:
      "A maker, listener, and builder at heart, with a love for calm mornings and steady progress.",
    about_card_two_title: "Where I am now",
    about_card_two_body:
      "London, England — a city I’m grateful for, even as I look toward quieter soil.",
    about_card_three_title: "Where I hope to move",
    about_card_three_body:
      "Lithuania — somewhere with space to grow food, build a home, and belong.",
    wall_title: "Community wall",
    wall_intro:
      "This is the main discussion board. Leave questions, offers, notary leads, land leads, or advice, and I’ll reply when I can.",
    wall_note:
      "Please keep it kind, grounded, and respectful of local communities and families.",
    code_title: "Coding and craft",
    code_intro:
      "I’m a full stack software developer who loves thoughtful systems, simple tools, and practical learning.",
    code_skills_title: "Skills and tools",
    code_skill_html: "HTML",
    code_skill_css: "CSS",
    code_skill_js: "JavaScript",
    code_skill_python: "Python",
    code_skill_rust: "Rust",
    code_paragraph_one:
      "I’m interested in ways to bridge software / harness software that extends the communication range between devices, especially for rural or off-grid spaces.",
    code_paragraph_two:
      "The idea of small mesh networks is appealing — quiet, resilient, and useful without hype.",
    code_paragraph_three:
      "If you want to collaborate or co-learn, I’d love to hear from you.",
    contact_title: "Contact",
    contact_intro:
      "Send a message if you have advice, leads, or just a kind hello. I read everything and reply when I can.",
    contact_name_label: "Name",
    contact_name_placeholder: "Your name",
    contact_email_label: "Email",
    contact_email_placeholder: "you@example.com",
    contact_message_label: "Message",
    contact_message_placeholder: "Write your message here...",
    contact_button: "Send message",
    contact_warning:
      "This contact form is connected to a placeholder Formspree ID. Replace it before sharing publicly.",
    form_sending: "Sending...",
    form_success: "Thank you — your message was sent.",
    form_error:
      "Something went wrong. Please try again, or email me directly.",
    not_found_title: "Page not found",
    not_found_body:
      "The page you’re looking for wandered off. Let’s head back to familiar ground.",
    not_found_button: "Back to home"
  },
  lt: {
    skip_link: "Pereiti prie turinio",
    nav_home: "Pradžia",
    nav_about: "Apie",
    nav_wall: "Siena",
    nav_code: "Kodas",
    nav_contact: "Kontaktai",
    wordmark: "cepelinai",
    title_home: "cepelinai | Pradžia",
    title_about: "cepelinai | Apie",
    title_wall: "cepelinai | Siena",
    title_code: "cepelinai | Kodas",
    title_contact: "cepelinai | Kontaktai",
    title_404: "cepelinai | Puslapis nerastas",
    lang_toggle_label: "Perjungti kalbą",
    footer_title: "Ačiū, kad esi čia",
    footer_line: "Esu dėkingas už kiekvieną gerą žinutę ir pasidalintą užuominą.",
    footer_copyright: "© 2026 cepelinai. Sukurta su rūpesčiu.",
    social_ig_label: "Instagram",
    social_fb_label: "Facebook",
    social_yt_label: "YouTube",
    social_in_label: "LinkedIn",
    hero_title: "Lėtas, viltingas kūrimas",
    hero_sentence:
      "Tai mano dienoraštis apie žemės pirkimą ir sodybos namų kūrimą, tikintis sumaišyti tinkamus ingredientus, kad gimtų kažkas gražaus.",
    hero_support:
      "Esu Terence, rašantis apie ramius žingsnius link nedidelės sodybos Lietuvoje — dokumentus, žmones ir kasdienį mokymąsi.",
    hero_support_two:
      "Jei esate netoliese ar pažįstate šį kraštą, mielai išgirsiu istorijas, patarimus ar švelnius įspėjimus.",
    hero_button_meet: "Susipažinkime",
    hero_button_wall: "Prisijunk prie sienos",
    gentle_title: "Švelnūs kvietimai",
    card_land_title: "Žemė ir įsikūrimas",
    card_land_body:
      "Kaip išmintingai ieškoti, pagarbiai lankyti vietoves ir pamažu pasijusti kaip namuose?",
    card_notary_title: "Notaro ir teisinė pagalba",
    card_notary_body:
      "Ar esate notaras, arba pažįstate žmogų, galintį padėti naujakuriui?",
    card_sale_title: "Parduodama žemė ir vietos žinios",
    card_sale_body:
      "Ar žinote šeimų, svarstančių parduoti, ar žemės, tinkamos ramiam, apgalvotam kūrimui?",
    card_community_title: "Bendruomenės ryšiai",
    card_community_body:
      "Dėkoju už pažintis su kaimynais, augintojais ir žmonėmis, mylinčiais savo vietą.",
    stay_title: "Likime ryšyje",
    stay_body:
      "Jei norite kartais gauti naujienų, palikite el. paštą — parašysiu trumpai ir retai.",
    stay_email_label: "El. paštas",
    stay_email_placeholder: "jusu@pastas.lt",
    stay_button: "Gauti naujienas",
    stay_warning:
      "Ši forma prijungta prie laikino Formspree ID. Pakeiskite jį prieš renkant prenumeratas.",
    about_title: "Apie Terence",
    about_intro_one:
      "Mano vardas Terence. Esu iš Londono, Anglijos. Esu full stack programų kūrėjas.",
    about_intro_two:
      "Kraustausi į Lietuvą pirkti žemės ir kurti sodybą — savo mažą rojų — kantriai ir pagarbiai.",
    about_intro_three:
      "Noriu būti geras kaimynas, pirmiausia klausytis ir mokytis bendruomenių ritmo.",
    about_card_one_title: "Kas aš",
    about_card_one_body:
      "Kūrėjas ir klausytojas iš prigimties, mylintis ramius rytus ir nuoseklų progresą.",
    about_card_two_title: "Kur esu dabar",
    about_card_two_body:
      "Londonas, Anglija — miestas, kuriam dėkoju, net kai žiūriu į ramesnę žemę.",
    about_card_three_title: "Kur noriu persikelti",
    about_card_three_body:
      "Lietuva — vieta, kur galima auginti maistą, kurti namus ir priklausyti.",
    wall_title: "Bendruomenės siena",
    wall_intro:
      "Čia yra pagrindinė diskusijų lenta. Palikite klausimus, pasiūlymus, notaro ar žemės užuominas, patarimus — atsakysiu, kai galėsiu.",
    wall_note:
      "Prašau kalbėti šiltai, ramiai ir pagarbiai vietos bendruomenėms.",
    code_title: "Programavimas ir amatas",
    code_intro:
      "Esu full stack programų kūrėjas, vertinantis apgalvotas sistemas, paprastus įrankius ir praktinį mokymąsi.",
    code_skills_title: "Įgūdžiai ir įrankiai",
    code_skill_html: "HTML",
    code_skill_css: "CSS",
    code_skill_js: "JavaScript",
    code_skill_python: "Python",
    code_skill_rust: "Rust",
    code_paragraph_one:
      "Domiuosi, kaip kurti tiltus tarp įrenginių, pasitelkiant programinę įrangą, kuri išplečia ryšio nuotolį.",
    code_paragraph_two:
      "Mažų mesh tinklų idėja patraukli — tyli, atspari ir naudinga be reklaminio triukšmo.",
    code_paragraph_three:
      "Jei norite bendradarbiauti ar mokytis kartu, parašykite.",
    contact_title: "Kontaktai",
    contact_intro:
      "Parašykite, jei turite patarimų, užuominų ar tiesiog norite pasisveikinti. Skaitau viską ir atsakau, kai galiu.",
    contact_name_label: "Vardas",
    contact_name_placeholder: "Jūsų vardas",
    contact_email_label: "El. paštas",
    contact_email_placeholder: "jusu@pastas.lt",
    contact_message_label: "Žinutė",
    contact_message_placeholder: "Čia parašykite žinutę...",
    contact_button: "Siųsti žinutę",
    contact_warning:
      "Ši kontaktų forma prijungta prie laikino Formspree ID. Pakeiskite jį prieš dalijantis viešai.",
    form_sending: "Siunčiama...",
    form_success: "Ačiū — jūsų žinutė išsiųsta.",
    form_error:
      "Kažkas nepavyko. Pabandykite dar kartą arba parašykite el. paštu.",
    not_found_title: "Puslapis nerastas",
    not_found_body:
      "Ieškomas puslapis nuklydo. Grįžkime į pradžią.",
    not_found_button: "Grįžti į pradžią"
  }
};

const renderHeader = () => `
  <header class="site-header">
    <div class="header-inner">
      <a class="wordmark" href="./index.html" aria-label="cepelinai" data-i18n="wordmark">cepelinai</a>
      <nav class="nav-links" aria-label="Primary">
        <a href="./index.html" data-i18n="nav_home">Home</a>
        <a href="./about.html" data-i18n="nav_about">About</a>
        <a href="./wall.html" data-i18n="nav_wall">Wall</a>
        <a href="./code.html" data-i18n="nav_code">Code</a>
        <a href="./contact.html" data-i18n="nav_contact">Contact</a>
      </nav>
      <button
        class="language-toggle"
        id="lang-toggle"
        type="button"
        data-i18n="lang_toggle_label"
        data-i18n-attr="aria-label"
      >
        LT / EN
      </button>
    </div>
  </header>
`;

const renderFooter = () => `
  <footer class="site-footer">
    <div class="footer-inner">
      <div class="footer-top">
        <div class="footer-note">
          <h3 data-i18n="footer_title">Thank you for being here</h3>
          <p data-i18n="footer_line">I’m grateful for every kind message and every shared lead.</p>
        </div>
        <div class="social-bubbles" aria-label="Social links">
          <a
            class="social-bubble is-instagram"
            href="#"
            data-i18n="social_ig_label"
            data-i18n-attr="aria-label"
            aria-label="Instagram"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor">
              <path
                d="M7 3h10a4 4 0 0 1 4 4v10a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V7a4 4 0 0 1 4-4zm0 2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2H7zm5 3.5a4.5 4.5 0 1 1 0 9 4.5 4.5 0 0 1 0-9zm0 2a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zm5.5-2.75a1 1 0 1 1 0 2 1 1 0 0 1 0-2z"
              />
            </svg>
          </a>
          <a
            class="social-bubble is-facebook"
            href="#"
            data-i18n="social_fb_label"
            data-i18n-attr="aria-label"
            aria-label="Facebook"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor">
              <path d="M15 3h-3a4 4 0 0 0-4 4v3H5v4h3v7h4v-7h3l1-4h-4V7a1 1 0 0 1 1-1h3z" />
            </svg>
          </a>
          <a
            class="social-bubble is-youtube"
            href="#"
            data-i18n="social_yt_label"
            data-i18n-attr="aria-label"
            aria-label="YouTube"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor">
              <path
                d="M21.8 8.001a3 3 0 0 0-2.12-2.12C17.9 5.5 12 5.5 12 5.5s-5.9 0-7.68.38A3 3 0 0 0 2.2 8c-.38 1.78-.38 5.5-.38 5.5s0 3.72.38 5.5a3 3 0 0 0 2.12 2.12c1.78.38 7.68.38 7.68.38s5.9 0 7.68-.38a3 3 0 0 0 2.12-2.12c.38-1.78.38-5.5.38-5.5s0-3.72-.38-5.5zM10 16.5v-7l6 3.5-6 3.5z"
              />
            </svg>
          </a>
          <a
            class="social-bubble is-linkedin"
            href="#"
            data-i18n="social_in_label"
            data-i18n-attr="aria-label"
            aria-label="LinkedIn"
          >
            <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" fill="currentColor">
              <path
                d="M6 9h3v9H6zM7.5 3.5a1.75 1.75 0 1 1 0 3.5 1.75 1.75 0 0 1 0-3.5zM11 9h2.9v1.3h.04c.4-.75 1.4-1.55 2.88-1.55 3.08 0 3.65 2.03 3.65 4.67V18h-3v-4.1c0-.98-.02-2.24-1.37-2.24-1.37 0-1.58 1.07-1.58 2.17V18h-3z"
              />
            </svg>
          </a>
        </div>
      </div>
      <div class="footer-bottom" data-i18n="footer_copyright">
        © 2026 cepelinai. Built with care.
      </div>
    </div>
  </footer>
`;

const getTranslation = (lang, key) => {
  if (translations[lang] && translations[lang][key]) {
    return translations[lang][key];
  }
  if (translations.en && translations.en[key]) {
    return translations.en[key];
  }
  return key;
};

const applyTranslations = (lang) => {
  document
    .querySelectorAll("[data-i18n]:not([data-i18n-attr])")
    .forEach((element) => {
      const key = element.dataset.i18n;
      if (key) {
        element.textContent = getTranslation(lang, key);
      }
    });

  document.querySelectorAll("[data-i18n-attr]").forEach((element) => {
    const key = element.dataset.i18n;
    const attr = element.dataset.i18nAttr;
    if (key && attr) {
      element.setAttribute(attr, getTranslation(lang, key));
    }
  });
};

const setLanguage = (lang) => {
  document.documentElement.lang = lang;
  localStorage.setItem("preferredLanguage", lang);
  applyTranslations(lang);
};

const getPreferredLanguage = () => {
  const stored = localStorage.getItem("preferredLanguage");
  return stored === "en" || stored === "lt" ? stored : "lt";
};

const initLanguage = () => {
  const startingLang = getPreferredLanguage();
  setLanguage(startingLang);

  const toggle = document.getElementById("lang-toggle");
  if (toggle) {
    toggle.addEventListener("click", () => {
      const nextLang = document.documentElement.lang === "lt" ? "en" : "lt";
      setLanguage(nextLang);
    });
  }
};

const initForms = () => {
  const forms = document.querySelectorAll("form[data-form]");
  forms.forEach((form) => {
    const action = form.getAttribute("action") || "";
    const warning = form.querySelector("[data-form-warning]");
    if (warning && action.includes("yourFormId")) {
      warning.hidden = false;
    }

    if (!window.fetch) {
      return;
    }

    form.addEventListener("submit", async (event) => {
      event.preventDefault();
      const status = form.querySelector("[data-status]");
      const lang = document.documentElement.lang || "lt";
      if (status) {
        status.textContent = getTranslation(lang, "form_sending");
      }

      try {
        const response = await fetch(action, {
          method: form.getAttribute("method") || "POST",
          headers: {
            Accept: "application/json"
          },
          body: new FormData(form)
        });

        if (response.ok) {
          if (status) {
            status.textContent = getTranslation(lang, "form_success");
          }
          form.reset();
        } else if (status) {
          status.textContent = getTranslation(lang, "form_error");
        }
      } catch (error) {
        if (status) {
          status.textContent = getTranslation(lang, "form_error");
        }
      }
    });
  });
};

const injectLayout = () => {
  const headerTarget = document.getElementById("site-header");
  if (headerTarget) {
    headerTarget.innerHTML = renderHeader();
  }

  const footerTarget = document.getElementById("site-footer");
  if (footerTarget) {
    footerTarget.innerHTML = renderFooter();
  }
};

document.addEventListener("DOMContentLoaded", () => {
  injectLayout();
  initLanguage();
  initForms();
});
